I"‰@<h2 id="461-what-are-exceptions">46.1. What are Exceptions?</h2>

<p>Things donâ€™t always go according to plan when weâ€™re programming, and when issues arise, we run into exceptions. In this lesson, weâ€™ll learn about what exceptions are and when weâ€™ll run into them.</p>

<h3 id="documentation">Documentation</h3>
<ul>
  <li><a href="https://docs.python.org/3.7/tutorial/errors.html">Python Errors and Exceptions Documentation</a>
 -<a href="https://docs.python.org/3/library/exceptions.html">Python Exceptions Documentation</a></li>
</ul>

<h3 id="syntax-errors-vs-exceptions">Syntax Errors vs Exceptions</h3>

<p>As weâ€™ve been learning how to do various things with Python, weâ€™ve run into both syntax errors and exceptions. Thereâ€™s a subtle difference between the two: syntax errors cannot be recovered from. The reason that we canâ€™t recover from a syntax error is that our code is simply not valid Python code, so the parser doesnâ€™t know what to do with anything after it runs into the error.</p>

<p>Exceptions are issues that occur during the execution of syntactically valid code that prevents the code from executing as planned. An exception occurring doesnâ€™t necessarily mean that our program needs to fail; it might just mean that we need to do something differently.</p>

<p>An example of an exception that we can handle is a <code class="language-plaintext highlighter-rouge">TypeError</code>. This type of exception that we would run into if we tried to add an <code class="language-plaintext highlighter-rouge">int</code> and a <code class="language-plaintext highlighter-rouge">str</code> like this:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>&gt;&gt;&gt; 1 + 'a'
Traceback (most recent call last):
  File "&lt;stdin&gt;", line 1, in &lt;module&gt;
TypeError: unsupported operand type(s) for +: 'int' and 'str'
</code></pre></div></div>

<p>This might seem like something that we would never do, but say we had code that tried to add two different variables, without using type checking or type casting we canâ€™t know for certain that two random variables both hold onto types that can be added, so it is possible to run into a <code class="language-plaintext highlighter-rouge">TypeError</code> in that situation.</p>

<p>As we write more and more complex code, there will be times when we need to handle errors, raise errors ourselves, and even create custom error types.</p>

<h2 id="462-handling-exceptions-with-try-except-else-and-finally">46.2. Handling Exceptions with <code class="language-plaintext highlighter-rouge">try</code>, <code class="language-plaintext highlighter-rouge">except</code>, <code class="language-plaintext highlighter-rouge">else</code>, and <code class="language-plaintext highlighter-rouge">finally</code></h2>

<p>Not everything can go according to plan in our programs, but we should know when these scenarios arise and handle them appropriately. In this lesson, weâ€™ll take a look at how to handle exceptions in Python.</p>

<h3 id="documentation-1">Documentation</h3>

<ul>
  <li><a href="https://docs.python.org/3/reference/compound_stmts.html#the-try-statement">The try statement &amp; workflow</a></li>
  <li><a href="https://docs.python.org/3/reference/compound_stmts.html#the-try-statement">Python Errors and Exceptions Documentation</a></li>
  <li><a href="https://docs.python.org/3/library/exceptions.html">Python Exceptions Documentation</a></li>
</ul>

<h3 id="handling-exceptions-with-tryexceptelsefinally">Handling Exceptions with try/except/else/finally</h3>

<p>When we know that our code can raise an exception, we donâ€™t need to just accept it and let our program crash. We can handle these exceptions using the <a href="https://docs.python.org/3/reference/compound_stmts.html#the-try-statement">try statement</a>. This is a compound statement kind of like the <code class="language-plaintext highlighter-rouge">if</code> statement where we will also need to use <code class="language-plaintext highlighter-rouge">except</code>, and have access to <code class="language-plaintext highlighter-rouge">else</code> and <code class="language-plaintext highlighter-rouge">finally</code>. Letâ€™s break down what these do by writing a small program that will potentially raise an exception. Weâ€™ll call this program <code class="language-plaintext highlighter-rouge">using_try.py</code> and put it in a new directory called <code class="language-plaintext highlighter-rouge">exception_handling</code>:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ ~/exception_handling
$ touch ~/exception_handling/using_try.py
</code></pre></div></div>

<p><code class="language-plaintext highlighter-rouge">~/exception_handling/using_try.py</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import sys

print(f"Received argument {sys.argv[1]}")
</code></pre></div></div>
<p>If we run this script with an extra argument, then it will run successfully, but if we run it without any arguments, then weâ€™ll see an exception.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ python3.7 using_try.py testing
Received argument testing
$ python3.7 using_try.py
Traceback (most recent call last):
  File "using_try.py", line 3, in &lt;module&gt;
    print(f"Received argument {sys.argv[1]}")
IndexError: list index out of range
</code></pre></div></div>

<p>The exception is an <code class="language-plaintext highlighter-rouge">IndexError</code>, and itâ€™s being raised because the list returned from <code class="language-plaintext highlighter-rouge">sys.argv</code> doesnâ€™t have 2 elements, so there is no index of <code class="language-plaintext highlighter-rouge">1</code>. This is a completely reasonable thing for someone to do when using our script; it is easy to forget to pass in an argument. There are ways to handle this that donâ€™t involve using exception handling, but since indexing a list can potentially raise an exception, we should be ready to perform exception handling in our code.</p>

<p>To handle this, we need to place our code that could raise an exception within a try statement and then <code class="language-plaintext highlighter-rouge">except</code>, if it happens and do something else.</p>

<p><code class="language-plaintext highlighter-rouge">~/exception_handling/using_try.py</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import sys

try:
    print(f"Received argument {sys.argv[1]}")
except:
    print(f"Error: no arguments, please provide at least one argument")
    sys.exit(1)
</code></pre></div></div>

<p>This is the simplest kind of try/except, and this will catch any exception that might be raised by the code inside the <code class="language-plaintext highlighter-rouge">try</code> block. If we run this file again, we should see our print out.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ python3.7 using_try.py
Error: no arguments, please provide at least one argument
$ echo $?
1
</code></pre></div></div>

<p>Since this is still a case where we want to terminate our script, weâ€™re going to explicitly exit with a non-zero status code to indicate the user that things didnâ€™t go according to plan, but weâ€™re also able to shield the user from seeing the Python traceback and provide a better experience to anyone using our script.</p>

<p>We could make this more specific and only <code class="language-plaintext highlighter-rouge">except</code> a very specific exception, and even have multiple separate <code class="language-plaintext highlighter-rouge">except</code> blocks catching different kinds of exceptions. Letâ€™s introduce another potential exception and catch the exceptions separately:</p>

<p><code class="language-plaintext highlighter-rouge">~/exception_handling/using_try.py</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import sys

try:
    print(f"First argument {sys.argv[1]}")
    args = sys.argv
    random.shuffle(args)
    print(f"Random argument {args[0]}")
except IndexError as err:
    print(f"Error: no arguments, please provide at least one argument ({err})")
    sys.exit(1)
except NameError:
    print(f"Error: random module not loaded")
    sys.exit(1)
</code></pre></div></div>

<p>Letâ€™s run this without an argument and then with an argument:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ python3.7 using_try.py
Error: no arguments, please provide at least one argument (list index out of range)
$ python3.7 using_try.py testing
First argument testing
Error: random module not loaded
</code></pre></div></div>

<p>Notice that like a conditional statement with multiple branches, only one of the except blocks will run because as soon as an exception occurs, the execution of the try block stops. Additionally, we can assign the exception that is raised to a variable so that we can get more information from it by adding as <identifier> to our `except` clause.</identifier></p>

<h3 id="the-else-and-finally-statements">The else and finally Statements</h3>

<p>Now weâ€™re able to handle exceptions, but the exception handling workflow also facilitates a way for us to run code if no exception gets caught using <code class="language-plaintext highlighter-rouge">else</code>, and thereâ€™s also a way to run some code after any error handling, or the <code class="language-plaintext highlighter-rouge">else</code> block, by using <code class="language-plaintext highlighter-rouge">finally</code>. Since weâ€™re using <code class="language-plaintext highlighter-rouge">sys.exit</code>, we wouldnâ€™t be able to use <code class="language-plaintext highlighter-rouge">finally</code> as is, but letâ€™s make some modifications to see how both of these work.</p>

<p><code class="language-plaintext highlighter-rouge">~/exception_handling/using_try.py</code></p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>import sys
import random

try:
    print(f"First argument {sys.argv[1]}")
    args = sys.argv
    random.shuffle(args)
    print(f"Random argument {args[0]}")
except (IndexError, KeyError) as err:
    print(f"Error: no arguments, please provide at least one argument ({err})")
except NameError:
    print(f"Error: random module not loaded")
else:
    print("Else is running")
finally:
    print("Finally is running")
</code></pre></div></div>

<p>We did import <code class="language-plaintext highlighter-rouge">random</code> so that it is possible to successfully run the script. Letâ€™s give this a run to see how it goes:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ python3.7 using_try.py
Error: no arguments, please provide at least one argument (list index out of range)
Finally is running
$ python3.7 using_try.py testing
First argument testing
Random argument using_try.py
Else is running
Finally is running
$
</code></pre></div></div>

<h2 id="463-using-built-in-exceptions">46.3. Using Built-In Exceptions</h2>

<p>When it comes to exceptions most of the time weâ€™ll be using exception handling, but sometimes we want to raise an exception from our code and then expect the code using our code to handle the exceptions that we might potentially raise.</p>

<h3 id="documentation-2">Documentation</h3>
<ul>
  <li><a href="https://docs.python.org/3.7/tutorial/errors.html">Python Errors and Exceptions Documentation</a></li>
  <li><a href="https://docs.python.org/3/library/exceptions.html">Python Exceptions Documentation</a></li>
</ul>

<h3 id="creating-an-exception">Creating an Exception</h3>

<p>To trigger an exception in Python code we need to utilize another keyword: <code class="language-plaintext highlighter-rouge">raise</code>. We refer to this as â€œraising an exceptionâ€. Before we can raise an exception though, we need to create an exception, but thankfully exceptions are objects just like everything else. Hoping into the REPL, letâ€™s create our first exception:</p>

<p>$ python3.7</p>
<blockquote>
  <blockquote>
    <blockquote>
      <p>err = Exception(â€˜something went wrongâ€™)
err
Exception(â€˜something went wrongâ€™)
str(err)
â€˜something went wrongâ€™
dir(err)
[â€˜<strong>cause</strong>â€™, â€˜<strong>class</strong>â€™, â€˜<strong>context</strong>â€™, â€˜<strong>delattr</strong>â€™, â€˜<strong>dict</strong>â€™, â€˜<strong>dir</strong>â€™, â€˜<strong>doc</strong>â€™, â€˜<strong>eq</strong>â€™, â€˜<strong>format</strong>â€™, â€˜<strong>ge</strong>â€™, â€˜<strong>get
attribute</strong>â€™, â€˜<strong>gt</strong>â€™, â€˜<strong>hash</strong>â€™, â€˜<strong>init</strong>â€™, â€˜<strong>init_subclass</strong>â€™, â€˜<strong>le</strong>â€™, â€˜<strong>lt</strong>â€™, â€˜<strong>ne</strong>â€™, â€˜<strong>new</strong>â€™, â€˜<strong>reduce</strong>â€™, â€˜<strong>redu
ce_ex</strong>â€™, â€˜<strong>repr</strong>â€™, â€˜<strong>setattr</strong>â€™, â€˜<strong>setstate</strong>â€™, â€˜<strong>sizeof</strong>â€™, â€˜<strong>str</strong>â€™, â€˜<strong>subclasshook</strong>â€™, â€˜<strong>suppress_context</strong>â€™, â€˜<strong>traceb
ack</strong>â€™, â€˜argsâ€™, â€˜with_tracebackâ€™]
Notice that just creating an exception doesnâ€™t stop excecution. The Exception class is the parent class for most exceptions, and we can see these by using Exception.<strong>subclasses</strong>():</p>
    </blockquote>
  </blockquote>
</blockquote>

<blockquote>
  <blockquote>
    <blockquote>
      <p>Exception.<strong>subclasses</strong>()
[&lt;class â€˜TypeErrorâ€™&gt;, &lt;class â€˜StopAsyncIterationâ€™&gt;, &lt;class â€˜StopIterationâ€™&gt;, &lt;class â€˜ImportErrorâ€™&gt;, &lt;class â€˜OSErrorâ€™&gt;, &lt;class â€˜EOFErrorâ€™&gt;, &lt;class â€˜RuntimeErrorâ€™&gt;, &lt;class â€˜NameErrorâ€™&gt;, &lt;class â€˜AttributeErrorâ€™&gt;, &lt;class â€˜SyntaxErrorâ€™&gt;, &lt;class â€˜LookupErrorâ€™&gt;, &lt;class â€˜ValueErrorâ€™&gt;, &lt;class â€˜AssertionErrorâ€™&gt;, &lt;class â€˜ArithmeticErrorâ€™&gt;, &lt;class â€˜SystemErrorâ€™&gt;, &lt;class â€˜ReferenceErrorâ€™&gt;, &lt;class â€˜MemoryErrorâ€™&gt;, &lt;class â€˜BufferErrorâ€™&gt;, &lt;class â€˜Warningâ€™&gt;, &lt;class â€˜locale.Errorâ€™&gt;, &lt;class â€˜re.errorâ€™&gt;, &lt;class â€˜sre_parse.Verboseâ€™&gt;]
Letâ€™s dig a little deeper into the inheritance struction here:</p>
    </blockquote>
  </blockquote>
</blockquote>

<blockquote>
  <blockquote>
    <blockquote>
      <p>Exception.<strong>bases</strong>
(&lt;class â€˜BaseExceptionâ€™&gt;,)
BaseException.<strong>bases</strong>
(&lt;class â€˜objectâ€™&gt;,)
BaseException.<strong>subclasses</strong>()
[&lt;class â€˜Exceptionâ€™&gt;, &lt;class â€˜GeneratorExitâ€™&gt;, &lt;class â€˜SystemExitâ€™&gt;, &lt;class â€˜KeyboardInterruptâ€™&gt;]
Since BaseException only inherits from object it is essentially the parent of all errors, but we really wonâ€™t ever use it.</p>
    </blockquote>
  </blockquote>
</blockquote>

<p>Raising an Exception
Now that we know how to create an exception, letâ€™s go ahead and create and raise an exception from a new script called using_exceptions.py:</p>

<p>~/exception_handling/using_exceptions.py</p>

<p>import sys</p>

<p>if len(sys.argv) &lt; 2:
    raise Exception(â€˜not enough argumentsâ€™)</p>

<p>name = sys.argv[1]
print(fâ€Name is {name}â€)
Now, if we run into the situation where not enough arguments are provided when the script is run we can create and raise an exception with the message that we want. This puts us back to having a not great user experience for our script, but itâ€™s great for showcasing how to use exceptions.</p>

<p>Letâ€™s put this to the test:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>$ python3.7 using_exceptions.py
Traceback (most recent call last):
  File "using_exceptions.py", line 4, in &lt;module&gt;
    raise Exception("not enough arguments")
Exception: not enough arguments
$ python3.7 using_exceptions.py Keith
Name is Keith
</code></pre></div></div>

<h2 id="464-creating-custom-exception-types">46.4. Creating Custom Exception Types</h2>

<h2 id="465-using-assertions">46.5. Using Assertions</h2>

<p>[]:</p>

:ET
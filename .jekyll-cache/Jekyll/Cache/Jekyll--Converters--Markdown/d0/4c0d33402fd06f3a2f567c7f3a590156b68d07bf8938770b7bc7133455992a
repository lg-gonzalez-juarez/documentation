I"Å(<h1 id="using-matplotlib">Using Matplotlib</h1>

<h2 id="what-makes-a-good-chart">What Makes a Good Chart?</h2>

<h3 id="what-makes-a-good-chart-1">What Makes a Good Chart</h3>

<p>Perhaps this section should have been called â€œMisleading People with Chartsâ€.</p>

<h3 id="rules-for-good-charting">Rules for Good Charting</h3>
<ol>
  <li>Title: Make the title meaningful to the chart and to what the chart shows.</li>
  <li>Axes: Make sure they do not distort the data.</li>
  <li>Axes Labels: Should indicate what they show by stating the units. For example, years or miles per hour.</li>
  <li>Legend: If the chart shows information for more than one data sequence, make sure a legend is provided that shows the differentiation.</li>
</ol>

<p>Many of these seem like common sense, but representational mistakes can and do happen. Letâ€™s look at some examples, as shown in the article by National Geographic, <a href="https://www.nationalgeographic.com/news/2015/06/150619-data-points-five-ways-to-lie-with-charts/">â€œA Quick Guide to Spotting Graphics That Lieâ€</a>.</p>

<h2 id="bar-plots-histograms-and-scatter-plots">Bar Plots, Histograms, and Scatter Plots</h2>

<p>Creating an exceptional chart takes practice. In this lesson, weâ€™re going to practice creating a bar plot, a histogram, and a scatter plot! We will be using a dataset that has data appropriate for these types of charts.</p>

<h2 id="setup-jupyter-notebooks-on-server">Setup Jupyter Notebooks on Server</h2>

<p>Jupyter Notebooks allows you to create and share documents that contain live code, equations, visualizations, and narrative text. We need to set up Jupyter within a code-server by downloading a file:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo curl -O https://raw.githubusercontent.com/linuxacademy/content-using-pythons-maths-science-and-engineering-libraries/master/jupyter-setup/setup.sh
source setup.sh
</code></pre></div></div>

<p>Check that the server is running Jupyter:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>systemctl | grep jupyter
</code></pre></div></div>

<p>If itâ€™s active and running, it will say so:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>jupyter.service                                                         
loaded active running   Jupyter Notebook
</code></pre></div></div>

<p>If you donâ€™t see that it is, try enabling the service:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo systemctl enable --now jupyter.service
</code></pre></div></div>

<h3 id="matplotlib-setup">Matplotlib Setup</h3>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>python -m pip install matplotlib
</code></pre></div></div>

<p>Displaying charts and general operations inside of Jupyter Notebooks requires HTTP rather than an HTTPS protocol. This is a function of using code-server over a remote server.</p>

<p>To enable this function:</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>sudo systemctl enable code-server-http --now 
</code></pre></div></div>

<p>Reload your code server using <code class="language-plaintext highlighter-rouge">http://&lt;remote-server&gt;:9090</code>. Please note it must be HTTP, not HTTPS. If you are having trouble loading code-server, please check to make sure you are using <code class="language-plaintext highlighter-rouge">http</code> in the URL.</p>

<h3 id="bar-plots">Bar Plots</h3>

<p>Bar plots are relatively simple and are easy to demonstrate with a few data points.</p>

<h3 id="scenario">Scenario</h3>

<p>You are teaching five periods (classes) of Chemistry, and you are curious to see if there appears to be a discrepancy in the classes. So, you decide to use Matplotlib to look at the score averages for the last test by gender.</p>

<div class="language-plaintext highlighter-rouge"><div class="highlight"><pre class="highlight"><code>~/chart.py

# %% 
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt

# create a list for the periods, this is the "x" axis
labels = ["1", "2", "3", "5", "6"]

# create list of the scores you want to plot
boyscores = [32, 67, 90, 100, 92]
girlscores = [40, 74, 90, 92, 100]

# set the width of the bars
width = 0.3

# set the data to be plotted
plt.figure(figsize=(10,5))
y_pos = np.arange(len(labels))
plt.title('Boys and Girls Scores By Period')
plt.xlabel('Periods')
plt.ylabel('Score')
plt.xticks(y_pos, labels)
plt.bar(y_pos, boyscores, width=width, label='boys', color='green', align='center')
plt.bar(y_pos+width, girlscores, width=width, label="girls", color='blue', align='center')
plt.legend(loc='best')
plt.show()
</code></pre></div></div>

<h2 id="dataset">Dataset</h2>

<p>Scatter plots and histograms require more data. As a result, we are going to use a dataset we have used before. Information about this dataset is below.</p>

<p>Dataset obtained from Kaggle and created by <a href="https://www.kaggle.com/russellyates88">Rusty</a>.</p>

<p>These datasets were developed from:</p>

<ul>
  <li>United Nations Development Program (2018): Human development index (HDI) (<a href="http://hdr.undp.org/en/indicators/137506">Source</a>)</li>
  <li>World Bank (2018): World development indicators: GDP (current US$) by country: 1985 to 2016 (<a href="http://hdr.undp.org/en/indicators/137506">Source</a>)</li>
  <li>Szamil from Kaggle (2017): Suicide in the Twenty-First Century dataset (<a href="https://www.kaggle.com/szamil/suicide-in-the-twenty-first-century/notebook">Source</a>)
-World Health Organization (2018): Suicide prevention (<a href="http://www.who.int/mental_health/suicide-prevention/en/">Source</a>)</li>
</ul>

<p>Download the data file from the repo:</p>

<p>! curl -O https://raw.githubusercontent.com/linuxacademy/content-using-pythons-maths-science-and-engineering-libraries/master/hdi_master.csv
Setting Up the Data
To create the environment we need, we should import pandas, NumPy, and Matplotlib from within the Python REPL:</p>

<p>import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
NumPy and pandas can help you isolate the data you want to chart but are not necessary. However, they are usually used to prepare data for charting.</p>

<p>Histogram
In this example, we create a histogram of the Human Development Index (HDI) for a specific year. We will also examine how to put some statistical information in the plot.</p>

<p>Letâ€™s load and read the data, then set the DataFrame:</p>

<p>df = pd.read_csv(â€˜hdi_master.csvâ€™)
We are not going to spend time looking at the data as we have seen how to do that in a previous lesson.</p>

<h1 id="pick-the-year-you-are-interested-in-looking-at">pick the year you are interested in looking at</h1>
<p>year_of_interest = 2010</p>

<h1 id="get-the-data">get the data</h1>
<p>df_year_interest = df[df[â€˜yearâ€™]==year_of_interest]</p>
<h1 id="there-are-null-values-in-the-column-hdi-for-year-these-can-be-safely-ignored">There are null values in the column â€˜HDI for yearâ€™, these can be safely ignored</h1>
<p>missing_values = df[â€˜HDI for yearâ€™].isnull()</p>
<h1 id="filter-returns-truw-for-null-values-need-to-negate-that-to-get-values">filter returns truw for null values, need to negate that to get values</h1>
<p>hdi = df_year_interest[â€˜HDI for yearâ€™][~missing_values]</p>

<p>plt.figure(figsize=(15, 5))
plt.hist(hdi, facecolor=â€™orangeâ€™, alpha=0.5)</p>
<h1 id="add-mean">add mean</h1>
<p>plt.axvline(hdi.mean(), color=â€™bâ€™, linestyle=â€™solidâ€™, linewidth=2, label=â€™meanâ€™)</p>
<h1 id="1-sd">+1 sd</h1>
<p>plt.axvline(hdi.mean() + hdi.std(), color=â€™bâ€™, linestyle=â€™dashedâ€™, linewidth=2, label=â€™+1 standard deviationâ€™)</p>
<h1 id="-1-sd">-1 sd</h1>
<p>plt.axvline(hdi.mean() - hdi.std(), color=â€™bâ€™, linestyle=â€™dashedâ€™, linewidth=2, label=â€™-1 standard deviationâ€™)</p>

<p>plt.title(fâ€™HDI for {year_of_interest}â€™)
plt.xlabel(â€˜HDI valueâ€™)
plt.ylabel(â€˜count of specific HDI valuesâ€™)
plt.legend(loc=â€™upper leftâ€™)
plt.show()
Line Plot and Scatter Plot
In this example, we look at the suicides/100k population using a line plot. Afterward, we look at how easy it is to change the plot by just renaming the plot type to a scatter plot.</p>

<h1 id="create-dataframe-for-male-and-female">create dataframe for male and female</h1>
<p>df_male = df[df[â€˜sexâ€™]==â€™maleâ€™].copy()
df_female = df[df[â€˜sexâ€™]==â€™femaleâ€™].copy()</p>

<h1 id="comparison-on-same-graph">Comparison on same graph</h1>
<p>suicides_by_male = df_male[â€˜suicides/100k popâ€™].groupby(df[â€˜yearâ€™]).mean().reset_index(level=0)
suicides_by_female = df_female[â€˜suicides/100k popâ€™].groupby(df[â€˜yearâ€™]).mean().reset_index(level=0)
plt.figure(figsize=(15, 5))</p>
<h1 id="pltsubplot111">plt.subplot(1,1,1)</h1>
<p>plt.plot(suicides_by_male[â€˜yearâ€™], suicides_by_male[â€˜suicides/100k popâ€™], color=â€™redâ€™, alpha=0.5, label=â€™maleâ€™)
plt.plot(suicides_by_female[â€˜yearâ€™], suicides_by_female[â€˜suicides/100k popâ€™], color=â€™blueâ€™, alpha=0.5, label=â€™femaleâ€™)
plt.title(fâ€™Male and Female Suicide Ratesâ€™)
plt.xlabel(â€˜yearâ€™)
plt.xticks(rotation=90)
ax = plt.gca()
ax.set_ylim([0, 30])
plt.ylabel(â€˜suicides/100k popâ€™)
plt.legend(loc=â€™bestâ€™)
plt.show()</p>

<h1 id="group-suicide-rates-by-year-and-plot">group suicide rates by year and plot</h1>

<p>suicides_by_male = df_male[â€˜suicides/100k popâ€™].groupby(df[â€˜yearâ€™]).mean().reset_index(level=0) 
suicides_by_female = df_female[â€˜suicides/100k popâ€™].groupby(df[â€˜yearâ€™]).mean().reset_index(level=0)</p>

<p>plt.figure(figsize=(15,5))</p>

<p>plt.subplot(1,2,1)
plt.plot(suicides_by_male[â€˜yearâ€™], suicides_by_male[â€˜suicides/100k popâ€™], color=â€™blueâ€™, alpha=0.5)
plt.title(fâ€™Male Suicide Ratesâ€™)
plt.xlabel(â€˜yearâ€™)
plt.xticks(rotation=90)
plt.ylabel(â€˜suicides/100k popâ€™)
plt.ylim([0, 30])</p>

<p>plt.subplot(1,2,2)
plt.plot(suicides_by_female[â€˜yearâ€™], suicides_by_female[â€˜suicides/100k popâ€™], color=â€™redâ€™, alpha=0.5)
plt.title(fâ€™Female Suicide Ratesâ€™)
plt.xlabel(â€˜yearâ€™)
plt.xticks(rotation=90)
plt.ylabel(â€˜suicides/100k popâ€™)
plt.ylim([0, 30])</p>

<p>plt.show()</p>
:ET